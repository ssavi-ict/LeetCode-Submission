{"id":693516037,"lang":"mssql","lang_name":"MS SQL Server","time":"7 months, 3 weeks","timestamp":1651733527,"status":10,"status_display":"Accepted","runtime":"3135 ms","url":"/submissions/detail/693516037/","is_pending":"Not Pending","title":"Monthly Transactions I","memory":"0B","code":"/* Write your T-SQL query statement below */\nSELECT \nFORMAT(trans_date, 'yyyy-MM') AS month,\ncountry, \nCOUNT(id) AS trans_count, \nSUM(case when state = 'approved' then 1 else 0 end) AS approved_count, \nSUM(amount) AS trans_total_amount, \nSUM(CASE \n    WHEN state = 'approved' THEN amount \n    ELSE 0 \n    END) AS approved_total_amount\nFROM Transactions\nGROUP BY FORMAT(trans_date, 'yyyy-MM'), country","compare_result":"11111111111111","title_slug":"monthly-transactions-i","has_notes":false,"notes":"","topic_tags":[]}